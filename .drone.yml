matrix:
  VARIATION:
    - "normal"
    - "alpine"
  VERSION:
    - "1.4.2"
    - "1.5.3"
    - "1.6rc1"

publish:
  docker:
    file: "$$VERSION/Dockerfile"
    context: "$$VERSION"
    username: $$DOCKER_USER
    email: $$DOCKER_EMAIL
    password: $$DOCKER_PASSWORD
    repo: armhfbuild/golang
    tag:
      - "$$VERSION"
      - "1.4"
    force_tag: true
    storage_driver: overlay
    when:
      VERSION: "1.4.2"
      VARIATION: "normal"

  docker:
    file: "$$VERSION/alpine/Dockerfile"
    context: "alpine/$$VERSION"
    username: $$DOCKER_USER
    email: $$DOCKER_EMAIL
    password: $$DOCKER_PASSWORD
    repo: armhfbuild/golang
    tag:
      - "$$VERSION-alpine"
      - "1.4-alpine"
    force_tag: true
    storage_driver: overlay
    when:
      VERSION: "1.4.2"
      VARIATION: "alpine"

  docker:
    file: "$$VERSION/Dockerfile"
    context: "$$VERSION"
    username: $$DOCKER_USER
    email: $$DOCKER_EMAIL
    password: $$DOCKER_PASSWORD
    repo: armhfbuild/golang
    tag:
      - "$$VERSION"
      - "1.5"
    force_tag: true
    storage_driver: overlay
    when:
      VERSION: "1.5.3"
      VARIATION: "normal"

  docker:
    file: "$$VERSION/alpine/Dockerfile"
    context: "alpine/$$VERSION"
    username: $$DOCKER_USER
    email: $$DOCKER_EMAIL
    password: $$DOCKER_PASSWORD
    repo: armhfbuild/golang
    tag:
      - "$$VERSION-alpine"
      - "1.5-alpine"
    force_tag: true
    storage_driver: overlay
    when:
      VERSION: "1.5.3"
      VARIATION: "alpine"

  docker:
    file: "$$VERSION/Dockerfile"
    context: "$$VERSION"
    username: $$DOCKER_USER
    email: $$DOCKER_EMAIL
    password: $$DOCKER_PASSWORD
    repo: armhfbuild/golang
    tag:
      - "$$VERSION"
      - "1.6"
    force_tag: true
    storage_driver: overlay
    when:
      VERSION: "1.6rc1"
      VARIATION: "normal"

  docker:
    file: "$$VERSION/alpine/Dockerfile"
    context: "alpine/$$VERSION"
    username: $$DOCKER_USER
    email: $$DOCKER_EMAIL
    password: $$DOCKER_PASSWORD
    repo: armhfbuild/golang
    tag:
      - "$$VERSION-alpine"
      - "1.6-alpine"
    force_tag: true
    storage_driver: overlay
    when:
      VERSION: "1.6rc1"
      VARIATION: "alpine"
